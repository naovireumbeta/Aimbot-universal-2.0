-- RAYFIELD
local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()

-- SERVICES
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")

local player = Players.LocalPlayer
local camera = workspace.CurrentCamera

-- AIM VARS (OFF)
local aimActive = false
local fovValue = 100
local stickyForce = 0.9

-- ESP VARS (ALL OFF)
local ESP_Line = false
local ESP_Box = false
local ESP_Health = false
local ESPObjects = {}

-- ESP CONFIG
local ESPSettings = {
    LineColor = Color3.fromRGB(255,255,255),
    Thickness = 1.5,
    MaxDistance = 1200
}

-- WINDOW
local Window = Rayfield:CreateWindow({
    Name = "aimbot2.0",
    LoadingTitle = "aimbot",
    LoadingSubtitle = "Aim + ESP",
    ConfigurationSaving = {Enabled = false}
})

-- TABS
local AimTab = Window:CreateTab("AIM", 4483362458)
local ESPTab = Window:CreateTab("ESP", 4483362458)
local InfoTab = Window:CreateTab("INFO", 4483362458)

-- INFO
InfoTab:CreateParagraph({
    Title = "Informações",
    Content = "Criador: @naovirebeta\nLançamento: 20/01/2026"
})

-- AIM
AimTab:CreateToggle({
    Name = "Aimbot",
    CurrentValue = false,
    Callback = function(v)
        aimActive = v
    end
})

AimTab:CreateSlider({
    Name = "FOV",
    Range = {20,360},
    Increment = 1,
    CurrentValue = fovValue,
    Callback = function(v)
        fovValue = v
    end
})

AimTab:CreateSlider({
    Name = "Smooth",
    Range = {1,100},
    Increment = 1,
    CurrentValue = stickyForce*100,
    Callback = function(v)
        stickyForce = v/100
    end
})

-- ESP
ESPTab:CreateToggle({
    Name = "ESP Line",
    CurrentValue = false,
    Callback = function(v)
        ESP_Line = v
    end
})

ESPTab:CreateToggle({
    Name = "ESP Box",
    CurrentValue = false,
    Callback = function(v)
        ESP_Box = v
    end
})

ESPTab:CreateToggle({
    Name = "ESP Health",
    CurrentValue = false,
    Callback = function(v)
        ESP_Health = v
    end
})

-- ===== ESP SYSTEM =====
local function NewDrawing(t)
    local o = Drawing.new(t)
    o.Visible = false
    return o
end

local function CreateESP(p)
    if p == player then return end
    ESPObjects[p] = {
        Line = NewDrawing("Line"),
        Box = NewDrawing("Square"),
        Health = NewDrawing("Square")
    }

    local d = ESPObjects[p]
    d.Line.Color = ESPSettings.LineColor
    d.Line.Thickness = ESPSettings.Thickness

    d.Box.Color = ESPSettings.LineColor
    d.Box.Thickness = ESPSettings.Thickness
    d.Box.Filled = false

    d.Health.Filled = true
end

local function RemoveESP(p)
    if ESPObjects[p] then
        for _,v in pairs(ESPObjects[p]) do v:Remove() end
        ESPObjects[p] = nil
    end
end

-- FOV CIRCLE
local fovCircle = Drawing.new("Circle")
fovCircle.Color = Color3.fromRGB(0,255,255)
fovCircle.Thickness = 2
fovCircle.Filled = false
fovCircle.Visible = true

-- ESP LOOP
RunService.RenderStepped:Connect(function()
    fovCircle.Radius = fovValue
    fovCircle.Position = Vector2.new(
        camera.ViewportSize.X/2,
        camera.ViewportSize.Y/2
    )

    for p,d in pairs(ESPObjects) do
        local char = p.Character
        local hum = char and char:FindFirstChildOfClass("Humanoid")
        local head = char and char:FindFirstChild("Head")
        local hrp = char and char:FindFirstChild("HumanoidRootPart")

        if not (char and hum and head and hrp and hum.Health > 0) then
            for _,v in pairs(d) do v.Visible = false end
            continue
        end

        local pos,vis = camera:WorldToViewportPoint(head.Position)
        if not vis then
            for _,v in pairs(d) do v.Visible = false end
            continue
        end

        local dist = (camera.CFrame.Position - hrp.Position).Magnitude
        if dist > ESPSettings.MaxDistance then
            for _,v in pairs(d) do v.Visible = false end
            continue
        end

        local h = math.clamp(2000/dist, 10, 300)
        local w = h/2

        if ESP_Line then
            d.Line.From = Vector2.new(camera.ViewportSize.X/2,0)
            d.Line.To = Vector2.new(pos.X,pos.Y)
            d.Line.Visible = true
        else d.Line.Visible = false end

        if ESP_Box then
            d.Box.Size = Vector2.new(w,h)
            d.Box.Position = Vector2.new(pos.X-w/2,pos.Y-h/4)
            d.Box.Visible = true
        else d.Box.Visible = false end

        if ESP_Health then
            local hp = hum.Health/hum.MaxHealth
            d.Health.Size = Vector2.new(4,h*hp)
            d.Health.Position = Vector2.new(
                d.Box.Position.X-6,
                d.Box.Position.Y+(h*(1-hp))
            )
            d.Health.Color = Color3.fromRGB(255-(hp*255),hp*255,0)
            d.Health.Visible = true
        else d.Health.Visible = false end
    end
end)

-- PLAYER HANDLER
for _,p in pairs(Players:GetPlayers()) do CreateESP(p) end
Players.PlayerAdded:Connect(CreateESP)
Players.PlayerRemoving:Connect(RemoveESP)

-- AIM TARGET
local function getClosestPlayer()
    local target, dist = nil, fovValue
    local center = Vector2.new(
        camera.ViewportSize.X/2,
        camera.ViewportSize.Y/2
    )

    for _,p in pairs(Players:GetPlayers()) do
        if p ~= player and p.Character and p.Character:FindFirstChild("Head") then
            local pos,vis = camera:WorldToViewportPoint(p.Character.Head.Position)
            if vis then
                local mag = (Vector2.new(pos.X,pos.Y)-center).Magnitude
                if mag < dist then
                    dist = mag
                    target = p.Character.Head
                end
            end
        end
    end
    return target
end

-- AIM LOOP
RunService.RenderStepped:Connect(function()
    if aimActive then
        local t = getClosestPlayer()
        if t then
            camera.CFrame = camera.CFrame:Lerp(
                CFrame.new(camera.CFrame.Position, t.Position),
                stickyForce
            )
        end
    end
end)
